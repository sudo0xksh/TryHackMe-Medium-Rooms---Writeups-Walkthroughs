# Wonderland â€” TryHackMe (Medium) ğŸ‡ğŸ§ ğŸ©

Wonderland is not about exploits.
Itâ€™s about **understanding how code actually executes**.

No scanners saving you.
No payload spam.
Just logic, imports, PATHs, and trust assumptions falling apart.

If you rush, you miss it.
If you read, you win.

---

## Machine Overview ğŸ–¥ï¸ğŸ“Œ

Room Name: Wonderland  
Operating System: Linux  
Difficulty: Medium  

Core focus areas:
- Web enumeration through **logic clues**
- SSH-based foothold
- **Python Import Hijacking**
- **PATH Hijacking**
- Lateral movement
- **SUID abuse via GTFOBins**

This machine tests **mindset**, not tooling.

---

## Reconnaissance ğŸ”

Initial scan revealed a very small attack surface:

- 22/tcp  SSH ğŸ”  
- 80/tcp  HTTP ğŸŒ  

Thatâ€™s it.

Small surface usually means:
ğŸ‘‰ No brute force  
ğŸ‘‰ No spray-and-pray  
ğŸ‘‰ Logic-based exploitation incoming

---

## Web Enumeration ğŸŒğŸ§

The homepage displayed a single hint:

> **"Follow the white rabbit."**

No robots.txt  
No obvious source code comments  

Directory enumeration revealed a hidden path:

/r/a/b/b/i/t

css
Copy code

Inside the page source:
- Hardcoded credentials were found

Credentials:
alice : HowDothTheLittleCrocodileImproveHisShiningTail

yaml
Copy code

This was the intended entry point.

---

## Initial Foothold ğŸ‡

Using the discovered credentials:

ssh alice@target

yaml
Copy code

Result:
- Login successful
- Initial foothold as **alice**

Clean and intentional.

---

## Privilege Escalation â€” Part 1  
### Python Import Hijacking ğŸğŸ’¥

Checking sudo permissions revealed:
- Alice could run a **Python script as user `rabbit`**

At first glance:
- Script logic looked harmless

Thatâ€™s the trap.

---

### Vulnerable Behavior

The script contained:

```python
import random
Critical mistake:

No absolute path used

Python import resolution order:

Current directory

PYTHONPATH

Standard library

This opens the door for import hijacking.

Exploitation
A malicious random.py was created in the working directory:

python
Copy code
import os
os.system("/bin/bash")
When the script was executed:

Python loaded the attacker-controlled random.py

Code execution triggered automatically

Result:

Shell obtained as rabbit

No exploit.
Just understanding Python.

Privilege Escalation â€” Part 2
PATH Hijacking â˜•ğŸš€
As user rabbit, further enumeration revealed:

A binary named teaParty

Executed with elevated privileges

Static analysis showed:

The binary executed the date command

No absolute path used

Conceptually:

c
Copy code
system("date");
Thatâ€™s a problem.

Exploitation
A fake date script was created:

bash
Copy code
#!/bin/bash
/bin/bash
Steps:

Made executable

Placed earlier in $PATH

When teaParty was executed:

It ran the fake date

Spawned a shell in a higher-privileged context

PATH hijacking done right.

Lateral Movement â€” hatter ğŸ©
From this context:

Credentials for user hatter were discovered

SSH login as hatter succeeded

Another trust boundary crossed.

Final Privilege Escalation
SUID Abuse (Perl) ğŸ‘‘
As hatter, enumeration revealed:

A Perl binary with the SUID bit set

Classic GTFOBins scenario.

Exploitation:

bash
Copy code
perl -e 'exec "/bin/bash";'
Because of SUID:

Shell executed as root

Game over.

Flags ğŸ
User Flag: Retrieved during initial access

Root Flag: Retrieved after Perl SUID escalation

Wonderland fully compromised.

Real Learnings ğŸ§ ğŸ“Œ
1ï¸âƒ£ Code doesnâ€™t need to look vulnerable
Missing absolute paths are vulnerabilities

2ï¸âƒ£ Two real-world exploitation techniques:

Python Import Hijacking

PATH Hijacking

These are production bugs, not CTF tricks.

3ï¸âƒ£ Wonderland tests mindset, not tools

No exploit-db

No Metasploit

No brute force

Only:

Reading code

Understanding execution flow

Trust boundaries failing quietly

ğŸ“¬ Contact & Projects ğŸ‘¨â€ğŸ’»ğŸ“
Daksh Baweja
ğŸ“§ Email: dakshbaweja20@gmail.com
ğŸ™ GitHub: https://github.com/sudo0xksh
ğŸ”— LinkedIn: https://www.linkedin.com/in/dakshbaweja

ğŸš€ Deteroid ğŸ”¥
Deteroid is a community-driven platform for bug bounty hunters
to share insights, rate programs, and collaborate on real-world findings.

Built to help hackers hunt smarter, not louder.

ğŸ“¸ Instagram: https://www.instagram.com/deteroids/

Final Words â˜•
Wonderland teaches one brutal truth:

â€œThe vulnerability isnâ€™t in the code.
Itâ€™s in the assumptions.â€
